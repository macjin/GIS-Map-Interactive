<!DOCTYPE html>
<head>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>



  <link rel="stylesheet" href="css/fullscreen.css" />
  <link rel="stylesheet" href="css/leaflet.css" />
  <link rel="stylesheet" href="css/icons.css" />
  <link rel="stylesheet" href="css/stylesheet.css" />
	<script src="js/data/shops.js"></script>
	<script src="js/data/ak_riks_muncipality_4.js"></script>
	<script src="js/data/mo_riks_islands_1.js"></script>
	<script src="js/data/mh_riks_sea_0.js"></script>
  <!--[if lte IE 8]>
      <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.ie.css" />
  <![endif]-->

  <!--[if lt IE 9]>
      <link rel="stylesheet" href="//rawgithub.com/domoritz/leaflet-locatecontrol/gh-pages/dist/L.Control.Locate.ie.min.css"/>
  <![endif]-->

  <!-- JSON data-->
  <script src="js/data/swe_counties.js" type="text/javascript"></script>

  <script src="js/leaflet.js"></script>
  <script src="js/leaflet-panel-layers.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script src="http://rawgithub.com/domoritz/leaflet-locatecontrol/gh-pages/dist/L.Control.Locate.min.js" ></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script type="text/javascript">
      google.charts.load('current', {
        'packages':['geochart'],
        // Note: you will need to get a mapsApiKey for your project.
        // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
        'mapsApiKey': 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
      });
      google.charts.setOnLoadCallback(drawRegionsMap);

      function drawRegionsMap() {
        var data = google.visualization.arrayToDataTable([
          ['Country', 'Popularity'],
          ['Germany', 200],
          ['United States', 300],
          ['Brazil', 400],
          ['Canada', 500],
          ['France', 600],
          ['RU', 700]
        ]);

        var options = {};

        var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

        chart.draw(data, options);
      }
    </script>
</head>
<body>

  <div class="icon-bar">
    <a style="background:white;" href="#"><img src="images/menu.png" class=""/></a>
    <a href="#"><i class="fa fa-calculator"></i></a>
    <a href="#"><i class="fa fa-book"></i></a>
    <a href="#"><i class="fa fa-archive"></i></a>
    <a href="#"><i class="fa fa-briefcase"></i></a>
    <a href="#"><i class="fa fa-calendar"></i></a>
    <a class="searchFinder" href="#"><i class="fa fa-search"></i></a>
  </div>

  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 noP">
    <input class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="flip"/>
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="panel"> Search Result</div>
  </div>

  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 noP">
    <div id="map"></div>
  </div>
  <!--
	<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 noP">
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4" style="height:20vh; border:1px solid red;">
      <div id="chart_div"></div>
      <button id="hide1">Show/Hide</button>
    </div>
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4" style="border:1px solid blue;">

          <div id="regions_div"  ></div>
          <button id="hide2">Show/Hide</button>
    </div>
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4" style="height:20vh; border:1px solid lime;">
      <iframe id="x" src="http://127.0.0.1:3000/" width="600" height="800" marginwidth="0" marginheight="0" frameborder="no" scrolling="yes"></iframe>
    </div>
  </div>
-->
	<script src="js/fullscreen.js" ></script>
	<script src="js/fullscreen.min.js" ></script>

  <script>
  $(document).ready(function(){
      $("#hide1").click(function(){
        $("#chart_div").toggle(1000);
      });
      $("#hide2").click(function(){
        $("#regions_div").toggle();
      });

      $("#flip").on('keydown', function(e) {
        if(e.which == 13 || e.keyCode == 13){
          $("#panel").slideToggle("slow");
        }
      });
      $(".searchFinder").click(function () {
        $("#flip").toggle("slow");
        $("#panel").hide("slow");
      });
  });
  </script>
<script>
  // Tile layer types
	var osmTerrain = L.tileLayer('http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}',{
			maxZoom: 20,
			subdomains:['mt0','mt1','mt2','mt3']
	});
	var osmStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{
			maxZoom: 20,
			subdomains:['mt0','mt1','mt2','mt3']
	});
	var osmNight = L.tileLayer('http://map1.vis.earthdata.nasa.gov/wmts-webmerc/VIIRS_CityLights_2012/default/{time}/{tilematrixset}{maxZoom}/{z}/{y}/{x}.{format}', {
			attribution: 'Imagery provided by services from the Global Imagery Browse Services (GIBS), operated by the NASA/GSFC/Earth Science Data and Information System (<a href="https://earthdata.nasa.gov">ESDIS</a>) with funding provided by NASA/HQ.',
 			minZoom: 1,
			maxZoom: 8,
			format: 'jpg',
			time: '',
			tilematrixset: 'GoogleMapsCompatible_Level'
	});

  // Interactive Button layer types
  var mapster = [
    {
        name: "Muncipality Boundary",
        icon: iconByName('shops'),
        layer: L.geoJson(json_ak_riks_muncipality_4, {pointToLayer: featureToMarker, color: '#66d9ff', fillColor: '#0044FF', weight: 1,  opacity: 1, fillOpacity: .51 })
    },
    {
      name: "Sea",
      icon: iconByName('shops'),
      layer: L.geoJson(json_mh_riks_sea_0, {pointToLayer: featureToMarker, color: 'white', fillColor: '#3371d6', weight: 1,  opacity: .5, fillOpacity: .5 })
    },
    {
      name: "Islands",
      icon: iconByName('shops'),
      layer: L.geoJson(json_mo_riks_islands_1, {pointToLayer: featureToMarker, color: '#66d9ff', fillColor: '#0044FF', weight: 1,  opacity: .5, fillOpacity: .5 })
    },
    {
      name: "Rail Way Centres",
      icon: iconByName('shops'),
      layer: L.geoJson(Shops, {pointToLayer: featureToMarker })
    }
  ];

  function iconByName(name) {
    return '<i class="icon icon-'+name+'"></i>';
  }

  function featureToMarker(feature, latlng) {
    return L.marker(latlng, {
      icon: L.divIcon({
        className: 'marker-'+feature.properties.amenity,
      //	html: iconByName(feature.properties.amenity),
        iconUrl: '../images/markers/'+feature.properties.amenity+'.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
      })
    });
  }

  window.onload = function () {
 	var map = L.map('map', {
		layers: [osmTerrain],
    disableDefaultUI: true,
    gesturehandling: 'greedy',
    scrollwheel: false,
    zoomControl: true,

    fullscreenControl: {
        pseudoFullscreen: false
      },
		   }).setView([63, 20], 5);

   //tile layers
   //osm humanitarian
   osmHuman= L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}', {
    	maxZoom: 20,
    	subdomains:['mt0','mt1','mt2','mt3']

    }).addTo(map);

		L.control.locate().addTo(map);

		// get color depending on population density value
		function getColor(d) {
			return d > 100 ? '#800026' :
				   d > 50  ? '#BD0026' :
				   d > 20  ? '#E31A1C' :
				   d > 10  ? '#FC4E2A' :
				   d > 5   ? '#FD8D3C' :
				   d > 2   ? '#FEB24C' :
				   d > 1   ? '#FED976' :
				  '#FFEDA0';
		}
		//different styles for different layers
		//Styling for styleCounties
		function styleCounties(feature) {
			return {
				weight: 2,
				opacity: 1,
				color: 'white',
				dashArray: '5',
				fillOpacity: 0.7,
				fillColor: getColor(feature.properties.LANSKOD)
			};
		}
		//Styling for styleB
		function styleB(feature) {
			return {
				weight: 2,
				opacity: 1,
				color: 'white',
				dashArray: '5',
				fillOpacity: 0.7,
				fillColor: getColor(feature.properties.KOM_KOD)
			};
		}
		//Styling for styleC
		function styleC(feature) {
			return {
				weight: 2,
				opacity: 1,
				color: 'white',
				dashArray: '5',
				fillOpacity: 0.7,
				fillColor: getColor(feature.properties.coordinates)
			};
		}
		// L.GeoJson CaseOne
		// Style = styleCounties
		var caseOne = L.geoJson(counties, {
			style: styleCounties,
			onEachFeature: function (feature, layer) {
        popupOptions = {maxWidth: 200};
        layer.bindPopup("<b>Lands Namn:</b> " + feature.properties.LANSNAMN
  			+"<br> Kommun Namn: " + feature.properties.KOMMUNNAMN
  			+"<br> Kategori: " + feature.properties.KATEGORI
  			+"<br> Kommun Kod: " + feature.properties.KOMMUNKOD
  			+"<br><b></b> Landskod: "+ feature.properties.LANSKOD
  			+ "<br >K Kod: " + feature.properties.KKOD
  			+ "<br> Kom Kod: " + feature.properties.KOM_KOD
  			,popupOptions);
        //highlight
  			function highlightFeature(e) {
      		var layer = e.target;
      		layer.setStyle({
  				weight: 5,
  				color: '#666',
  				dashArray: '',
  				fillOpacity: 0.7
  			});

  			if (!L.Browser.ie && !L.Browser.opera) {
  				layer.bringToFront();
  				}
  				infoA.update(layer.feature.properties);
  			}
  					//reset function
  			function resetHighlight(e) {
  				caseOne.resetStyle(e.target);
  				infoA.update()
  			}
  			layer.on({
  				mouseover: highlightFeature,
  				mouseout: resetHighlight,
  			});
  		} //END OF ON EACH FEATURE

   }).addTo(map);

	// L.GeoJson CaseTwo
	// Style = styleB
	var caseTwo=L.geoJson(counties, {
		style: styleB,
		onEachFeature: function (feature, layer) {
      popupOptions = {maxWidth: 200};
      layer.bindPopup("<b>District:</b> " + feature.properties.LANSNAMN
      +"<br> Kommun Namn: " + feature.properties.KOMMUNNAMN
      +"<br> Kategori: " + feature.properties.KATEGORI
      +"<br> Kommun Kod: " + feature.properties.KOMMUNKOD
      +"<br><b></b> Landskod: "+ feature.properties.LANSKOD
      + "<br >K Kod: " + feature.properties.KKOD
      + "<br> Kom Kod: " + feature.properties.KOM_KOD
			,popupOptions);
			//highlight
			function highlightFeature(e) {
				var layer = e.target;
				layer.setStyle({
				weight: 5,
				color: '#666',
				dashArray: '',
				fillOpacity: 0.7
			});

			if (!L.Browser.ie && !L.Browser.opera) {
				layer.bringToFront();
			}
				infoB.update(layer.feature.properties);
			}
			//reset function
			function resetHighlight(e) {
				caseTwo.resetStyle(e.target);
				infoB.update();
			}
			layer.on({
				mouseover: highlightFeature,
				mouseout: resetHighlight,
			});
		 }

	})
	// L.GeoJson CaseThree
	// Style = styleC
	var caseThree=L.geoJson(counties, {
		style: styleC,
		onEachFeature: function (feature, layer) {
			popupOptions = {maxWidth: 200};
      layer.bindPopup("<b>District:</b> " + feature.properties.LANSNAMN
      +"<br> Kommun Namn: " + feature.properties.KOMMUNNAMN
      +"<br> Kategori: " + feature.properties.KATEGORI
      +"<br> Kommun Kod: " + feature.properties.KOMMUNKOD
      +"<br><b></b> Landskod: "+ feature.properties.LANSKOD
      + "<br >K Kod: " + feature.properties.KKOD
      + "<br> Kom Kod: " + feature.properties.KOM_KOD
			,popupOptions);
			//highlight
			function highlightFeature(e) {
				var layer = e.target;
				layer.setStyle({
				weight: 5,
				color: '#666',
				dashArray: '',
				fillOpacity: 0.7
			});

			if (!L.Browser.ie && !L.Browser.opera) {
				layer.bringToFront();
			}
				infoC.update(layer.feature.properties);
			}
			//reset function
			function resetHighlight(e) {
				caseThree.resetStyle(e.target);
				infoC.update();
			}
			layer.on({
				mouseover: highlightFeature,
				mouseout: resetHighlight,
			});
		 }

	})
	// END

	//LEGENDS START HERE
	//LegendA
	var legendA = L.control({position: 'bottomright'});

	legendA.onAdd = function (map) {

		var div = L.DomUtil.create('div', 'info legend'),
			grades = [0, 10, 20, 50, 100, 200, 500, 1000],
			labels = ["%"],
			from, to;

		for (var i = 0; i < grades.length; i++) {
			from = grades[i];
			to = grades[i + 1];

			labels.push(
				'<i style="background:' + getColor(from + 1) + '"></i> ' +
				from + (to ? '&ndash;' + to : '+'));
		}

		div.innerHTML = labels.join('<br>');
		return div;
	};

	//LegendB
	var legendB = L.control({position: 'bottomright'});

	legendB.onAdd = function (map) {

		var div = L.DomUtil.create('div', 'info legend'),
			grades = [0, 10, 20, 50, 100, 200, 500, 1000],
			labels = ["%"],
			from, to;

		for (var i = 0; i < grades.length; i++) {
			from = grades[i];
			to = grades[i + 1];

			labels.push(
				'<i style="background:' + getColor(from + 1) + '"></i> ' +
				from + (to ? '&ndash;' + to : '+'));
		}

		div.innerHTML = labels.join('<br>');
		return div;
	};

	//LegendC
	var legendC = L.control({position: 'bottomright'});

	legendC.onAdd = function (map) {

		var div = L.DomUtil.create('div', 'info legend'),
			grades = [0, 10, 20, 50, 100, 200, 500, 1000],
			labels = ["%"],
			from, to;

		for (var i = 0; i < grades.length; i++) {
			from = grades[i];
			to = grades[i + 1];

			labels.push(
				'<i style="background:' + getColor(from + 1) + '"></i> ' +
				from + (to ? '&ndash;' + to : '+'));
		}

		div.innerHTML = labels.join('<br>');
		return div;
	};

	legendA.addTo(map);
	currentLegend = legendA;

	//Basemap
	var baseMaps = {
		"Försäljning Butik:": caseOne,
		"Försäljning Web:": caseTwo,
		"Lager Status:": caseThree
	};

	var overlays = {
		"Terrain Map": osmTerrain,
		"Night Map": osmNight,
		"Street Map": osmStreets,
	};

  L.control.layers(baseMaps, overlays, mapster).addTo(map);

	var panelLayers = new L.Control.PanelLayers(mapster);

  map.addControl(panelLayers);
	//panelLayer EnD

	// control that shows state info on hover
	//infoA
	var infoA = L.control();

	infoA.onAdd = function (map) {
		this._div = L.DomUtil.create('div', 'info');
		this.update();
		return this._div;
	};

	infoA.update = function (props) {
		this._div.innerHTML = '<h4> Case 1 </h4>' +  (props ?
			'<b>' + props.KOMMUNNAMN + '</b>'
			+ '<br> <i>2014</i> <b><i> October: </b> ' + props.LANSKOD
			+ '<br> <i>2014</i> <b> November: </b> ' + props.KOMMUNKOD
			+ '<br> <i>2014</i> <b><i> December: </b> ' + props.KOM_KOD
			+ '<br> <i>2015</i> <b><i> January: </b> ' + props.KKOD
			+ '<br> <i>2015</i> <b> February: </b> ' + props.LAN_KOD
			+ '<br> <i>2015</i> <b><i> March: </b> ' + props.LANSKOD
			+ '<br> <i>2015</i> <b><i> April: </b> ' + props.KOMMUNKOD
			+ '<br> <i>2015</i> <b> May: </b> ' + props.KOM_KOD
			+ '<br> <i>2015</i> <b><i> June: </b> ' + props.KKOD
			+ '<br> <i>2015</i> <b><i> July: </b> ' + props.LAN_KOD
			: 'Hover over a district for more details');
	};

	//infoB
	var infoB = L.control();

	infoB.onAdd = function (map) {
		this._div = L.DomUtil.create('div', 'info');
		this.update();
		return this._div;
	};

	infoB.update = function (props) {
		this._div.innerHTML = '<h4> Case 2 </h4>' +  (props ?
      '<b>' + props.KOMMUNNAMN + '</b>'
			+ '<br> <i>2014</i> <b><i> October: </b> ' + props.LANSKOD
			+ '<br> <i>2014</i> <b> November: </b> ' + props.KOMMUNKOD
			+ '<br> <i>2014</i> <b><i> December: </b> ' + props.KOM_KOD
			+ '<br> <i>2015</i> <b><i> January: </b> ' + props.KKOD
			+ '<br> <i>2015</i> <b> February: </b> ' + props.LAN_KOD
			+ '<br> <i>2015</i> <b><i> March: </b> ' + props.LANSKOD
			+ '<br> <i>2015</i> <b><i> April: </b> ' + props.KOMMUNKOD
			+ '<br> <i>2015</i> <b> May: </b> ' + props.KOM_KOD
			+ '<br> <i>2015</i> <b><i> June: </b> ' + props.KKOD
			+ '<br> <i>2015</i> <b><i> July: </b> ' + props.LAN_KOD
			: 'Hover over a district for more details');
	};

	//infoC
	var infoC = L.control();

	infoC.onAdd = function (map) {
		this._div = L.DomUtil.create('div', 'info');
		this.update();
		return this._div;
	};

	infoC.update = function (props) {
		this._div.innerHTML = '<h4> Case 3 </h4>' +  (props ?
      '<b>' + props.KOMMUNNAMN + '</b>'
			+ '<br> <i>2014</i> <b><i> October: </b> ' + props.LANSKOD
			+ '<br> <i>2014</i> <b> November: </b> ' + props.KOMMUNKOD
			+ '<br> <i>2014</i> <b><i> December: </b> ' + props.KOM_KOD
			+ '<br> <i>2015</i> <b><i> January: </b> ' + props.KKOD
			+ '<br> <i>2015</i> <b> February: </b> ' + props.LAN_KOD
			+ '<br> <i>2015</i> <b><i> March: </b> ' + props.LANSKOD
			+ '<br> <i>2015</i> <b><i> April: </b> ' + props.KOMMUNKOD
			+ '<br> <i>2015</i> <b> May: </b> ' + props.KOM_KOD
			+ '<br> <i>2015</i> <b><i> June: </b> ' + props.KKOD
			+ '<br> <i>2015</i> <b><i> July: </b> ' + props.LAN_KOD
			: 'Hover over a district for more details');
	};


	infoA.addTo(map);
	currentInfo = infoA;

  map.on('baselayerchange', function (eventLayer) {
  	if (eventLayer.name === 'A:') {
  		map.removeControl(currentLegend);
  		currentLegend = legendA;
  		legendA.addTo(map);
  		 map.removeControl(currentInfo);
  		currentInfo=infoA;
  		infoA.addTo(map);
  	}
  	else if  (eventLayer.name === 'B:') {
          map.removeControl(currentLegend);
          currentLegend = legendB;
          legendB.addTo(map);
  		 map.removeControl(currentInfo);
  		currentInfo=infoB;
  		infoB.addTo(map);
      }
  	else if  (eventLayer.name === 'C:') {
          map.removeControl(currentLegend);
          currentLegend = legendC;
          legendC.addTo(map);
  		 map.removeControl(currentInfo);
  		currentInfo=infoC;
  		infoC.addTo(map);
      }
  })


}
</script>
<script type="text/javascript">
google.charts.load('current', {packages: ['corechart', 'bar']});
google.charts.setOnLoadCallback(drawTitleSubtitle);

function drawTitleSubtitle() {
      var data = google.visualization.arrayToDataTable([
        ['City', '2010 Population', '2000 Population'],
        ['New York City, NY', 8175000, 8008000],
        ['Los Angeles, CA', 3792000, 3694000],
        ['Chicago, IL', 2695000, 2896000],
        ['Houston, TX', 2099000, 1953000],
        ['Philadelphia, PA', 1526000, 1517000]
      ]);

      var materialOptions = {
        chart: {
          title: 'Population of Largest U.S. Cities',
          subtitle: 'Based on most recent and previous census data'
        },
        hAxis: {
          title: 'Total Population',
          minValue: 0,
        },
        vAxis: {
          title: 'City'
        },
        bars: 'horizontal'
      };
      var materialChart = new google.charts.Bar(document.getElementById('chart_div'));
      materialChart.draw(data, materialOptions);
    }
</script>
</body>
</html>
